<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ultimate Slot Machine</title>
<style>
  body {
    margin: 0;
    background: linear-gradient(135deg, #070707, #1a1a1a);
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: 'Poppins', sans-serif;
    color: white;
    overflow: hidden;
  }

  h1 {
    font-size: 40px;
    margin-bottom: 20px;
    text-shadow: 0 0 15px #ff0066;
  }

  .slot-container {
    display: flex;
    gap: 25px;
    padding: 25px;
    background: rgba(255,255,255,0.07);
    border-radius: 20px;
    border: 2px solid rgba(255,255,255,0.2);
    backdrop-filter: blur(10px);
    box-shadow: 0 0 20px rgba(255,50,80,0.5);
  }

  .slot {
    width: 90px;
    height: 90px;
    display: flex;
    justify-content: center;
    align-items: center;
    background: black;
    border-radius: 12px;
    border: 2px solid #ff2d75;
    font-size: 50px;
  }

  @keyframes reelSpin {
    0% { transform: translateY(0); }
    100% { transform: translateY(100%); }
  }

  button {
    margin-top: 15px;
    padding: 12px 35px;
    font-size: 20px;
    border: none;
    border-radius: 10px;
    background: linear-gradient(90deg, #ff0066, #ff2d75);
    cursor: pointer;
    color: white;
    box-shadow: 0 0 10px rgba(255,0,80,0.6);
  }

  #result {
    margin-top: 20px;
    font-size: 24px;
    text-shadow: 0 0 10px white;
  }

  #history {
    margin-top: 20px;
    width: 280px;
    background: rgba(255,255,255,0.05);
    padding: 10px;
    border-radius: 8px;
    height: 150px;
    overflow-y: auto;
    font-size: 14px;
  }

  @keyframes coinFall {
    from { transform: translateY(-50px); opacity: 1; }
    to { transform: translateY(600px); opacity: 0; }
  }
</style>
</head>
<body>
<h1>Ultimate Slot Machine</h1>

<div class="slot-container">
  <div id="slot1" class="slot">‚ùì</div>
  <div id="slot2" class="slot">‚ùì</div>
  <div id="slot3" class="slot">‚ùì</div>
</div>

<div style="margin-top: 20px; font-size: 20px;">
  Balance: <span id="balanceDisplay">100</span> ü™ô<br>
  Bet: <button id="betMinus">-</button> <span id="betAmount">5</span> <button id="betPlus">+</button>
</div>

<button onclick="spin()">SPIN</button>
<button id="autoSpinBtn">AUTO-SPIN: OFF</button>
<button id="bonusBtn">BONUS MODE</button>

<p id="result"></p>

<div id="history"><ul id="historyList"></ul></div>

<script>
// SYMBOLS WITH RARITY + PAYOUT
const symbols = [
  {icon: "üçí", weight: 45, payout: 4},
  {icon: "üçã", weight: 25, payout: 6},
  {icon: "üçá", weight: 15, payout: 12},
  {icon: "‚≠ê", weight: 10, payout: 25},
  {icon: "7Ô∏è‚É£", weight: 5, payout: 50},
  {icon: "üçÄ", weight: 3, payout: 80}
];

let balance = 100;
let bet = 5;
let spinning = false;
let autoSpinActive = false;
let bonusActive = false;
const history = [];

// RANDOM SYMBOL BASED ON WEIGHT
function getRandomSymbol() {
  const totalWeight = symbols.reduce((sum, s) => sum + s.weight, 0);
  let r = Math.random() * totalWeight;
  for (let s of symbols) {
    if (r < s.weight) return s;
    r -= s.weight;
  }
}

function updateUI() {
  document.getElementById("balanceDisplay").innerText = balance;
  document.getElementById("betAmount").innerText = bet;

  if (balance <= 0) {
    balance = 20;
    bet = 2;
    addHistory("Recovery mode activated +20 coins.");
  }
}

function addHistory(text) {
  history.unshift(text);
  if (history.length > 20) history.pop();
  document.getElementById("historyList").innerHTML = history.map(h => `<li>${h}</li>`).join(" ");
}

function animateCoinBurst() {
  for (let i = 0; i < 20; i++) {
    let c = document.createElement("div");
    c.innerText = "ü™ô";
    c.style.position = "absolute";
    c.style.left = Math.random()*window.innerWidth + "px";
    c.style.top = "-30px";
    c.style.fontSize = "25px";
    c.style.animation = "coinFall 1.5s linear";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),1500);
  }
}

function startReelSpin(reel, index, symbol) {
  let counter = 0;
  let interval = setInterval(() => {
    reel.innerText = symbols[Math.floor(Math.random()*symbols.length)].icon;
    counter++;
    if (counter >= 20 + index*5) {
      clearInterval(interval);
      reel.innerText = symbol.icon;
    }
  }, 60);
}

function spin() {
  if (spinning || bet > balance) return;
  spinning = true;
  balance -= bet;
  updateUI();

  const final = [getRandomSymbol(), getRandomSymbol(), getRandomSymbol()];

  startReelSpin(slot1, 0, final[0]);
  startReelSpin(slot2, 1, final[1]);
  startReelSpin(slot3, 2, final[2]);

  setTimeout(() => {
    let reward = 0;
    let msg = "";

    if (final[0].icon === final[1].icon && final[1].icon === final[2].icon) {
      reward = bet * final[0].payout * (bonusActive ? 2 : 1);
      msg = `JACKPOT! +${reward}`;
      animateCoinBurst();
    }
    else if (final[0].icon === final[1].icon || final[1].icon === final[2].icon || final[0].icon === final[2].icon) {
      reward = bet * 3;
      msg = `Match! +${reward}`;
      animateCoinBurst();
    }
    else msg = "No win.";

    balance += reward;
    addHistory(msg);
    document.getElementById("result").innerText = msg;
    spinning = false;
    updateUI();

    if (autoSpinActive) setTimeout(spin, 900);
  }, 1500);
}

document.getElementById("betMinus").onclick = () => { if (bet > 1) bet--; updateUI(); };
document.getElementById("betPlus").onclick = () => { if (bet < balance) bet++; updateUI(); };

document.getElementById("autoSpinBtn").onclick = () => {
  autoSpinActive = !autoSpinActive;
  document.getElementById("autoSpinBtn").innerText = autoSpinActive ? "AUTO-SPIN: ON" : "AUTO-SPIN: OFF";
  if (autoSpinActive) spin();
};

document.getElementById("bonusBtn").onclick = () => {
  bonusActive = !bonusActive;
  document.getElementById("bonusBtn").innerText = bonusActive ? "BONUS ACTIVE" : "BONUS MODE";
};

updateUI();
</script>

</body>
</html>
